<?xml version="1.0" encoding="UTF-8"?>
<ui:composition template="/templates/user/layout.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="jakarta.faces.facelets"
                xmlns:h="jakarta.faces.html"
                xmlns:f="http://xmlns.jcp.org/jsf/core">
    <ui:define name="content">
        <main class="flex-grow flex items-center justify-center p-4 lg:p-8">
            <div class="w-full max-w-5xl bg-white dark:bg-[#112116] rounded-2xl shadow-xl overflow-hidden flex flex-col md:flex-row border border-[#e8ecea] dark:border-[#2a4034]">
                <!-- Left Side: Hero Image -->
                <div class="relative w-full md:w-1/2 min-h-[300px] md:min-h-[600px] bg-gray-100">
                    <img alt="Fresh vegetables and fruits in a paper bag on a table" class="absolute inset-0 w-full h-full object-cover" data-alt="Fresh vegetables and fruits in a paper bag on a table" src="https://lh3.googleusercontent.com/aida-public/AB6AXuDlgwkZH3fsQiTfG2JkKO7pehFxPWVkaiZeXuTuJt_fG3a_mV9QXfkBJC4IlVErHZQ4j7Qb4Fk53gX8LCTxsG8gqaj543ctB-CtMVcvqAjm2qc7yrLrkw9FGc9MsLzTrUturmGZbBSSpWPvB1GbGmxfqPUvNOnaG-r5qkf2Gyrl-tG6GAMop9tDnB4wmyFi4e_kMxjP_Welp4homC3ZntlZlsvSq73OiYjl9SrvW8YkDhsadUhmVhutEMCzvUgPV0MUToydtgGIKKI"/>
                    <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent flex flex-col justify-end p-8 md:p-12">
                        <h3 class="text-white text-2xl md:text-3xl font-bold mb-2">Fresh groceries delivered to your doorstep.</h3>
                        <p class="text-white/90 text-sm md:text-base">Shop from a wide range of fresh produce and essentials.</p>
                    </div>
                </div>
                <!-- Right Side: Login Form -->
                <div class="w-full md:w-1/2 p-8 md:p-12 lg:p-16 flex flex-col justify-center">
                    <div class="max-w-md mx-auto w-full">
                        <!-- Header -->
                        <div class="mb-8 text-center md:text-left">
                            <h1 class="text-[#111813] dark:text-white tracking-tight text-[32px] font-bold leading-tight pb-3">#{locale.getMessage('login.title')}</h1>
                            <p class="text-[#63886f] text-base font-normal leading-normal">#{locale.getMessage('login.subtitle')}</p>
                        </div>
                        <!-- Error/Success Messages -->
                        <h:panelGroup layout="block" styleClass="space-y-2 mb-6">
                            <ui:repeat value="#{facesContext.messageList}" var="msg">
                                <div class="#{msg.severity.ordinal == 2 ? 'bg-red-100 dark:bg-red-900/30 border border-red-300 dark:border-red-700 text-red-800 dark:text-red-200' : 'bg-green-100 dark:bg-green-900/30 border border-green-300 dark:border-green-700 text-green-800 dark:text-green-200'} rounded-lg p-3 flex items-start gap-3">
                                    <span class="material-symbols-outlined flex-shrink-0 text-sm">#{msg.severity.ordinal == 2 ? 'error' : 'check_circle'}</span>
                                    <span class="text-sm">#{msg.summary}</span>
                                </div>
                            </ui:repeat>
                        </h:panelGroup>
                        <!-- Form -->
                        <h:form class="flex flex-col gap-6">
                            <!-- Email Field -->
                            <div class="flex flex-col gap-1.5">
                                <label class="text-[#111813] dark:text-white text-base font-medium leading-normal">#{locale.getMessage('login.emailLabel')}</label>
                                <div class="flex w-full items-stretch rounded-lg group focus-within:ring-2 focus-within:ring-primary focus-within:ring-offset-1 dark:focus-within:ring-offset-[#112116]">
                                    <h:inputText value="#{auth.identifier}" styleClass="form-input flex-1 resize-none overflow-hidden rounded-l-lg text-[#111813] border border-[#dce5df] bg-white focus:outline-none focus:border-primary focus:ring-0 h-14 placeholder:text-[#63886f] p-[15px] border-r-0 text-base" title="#{locale.getMessage('login.emailPlaceholder')}">
                                        <f:passThroughAttribute name="placeholder" value="#{locale.getMessage('login.emailPlaceholder')}" />
                                    </h:inputText>
                                    <div class="text-[#63886f] flex border border-[#dce5df] border-l-0 bg-white items-center justify-center pr-[15px] rounded-r-lg w-12">
                                        <span class="material-symbols-outlined">person</span>
                                    </div>
                                </div>
                            </div>
                            <!-- Password Field -->
                            <div class="flex flex-col gap-1.5">
                                <label class="text-[#111813] dark:text-white text-base font-medium leading-normal">#{locale.getMessage('login.passwordLabel')}</label>
                                <div class="flex w-full items-stretch rounded-lg group focus-within:ring-2 focus-within:ring-primary focus-within:ring-offset-1 dark:focus-within:ring-offset-[#112116]">
                                    <h:inputSecret id="login-pwd" value="#{auth.password}" styleClass="form-input flex-1 resize-none overflow-hidden rounded-l-lg text-[#111813] border border-[#dce5df] bg-white focus:outline-none focus:border-primary focus:ring-0 h-14 placeholder:text-[#63886f] p-[15px] border-r-0 text-base">
                                        <f:passThroughAttribute name="placeholder" value="#{locale.getMessage('login.passwordPlaceholder')}" />
                                    </h:inputSecret>
                                    <div id="pwd-toggle-login" class="text-[#63886f] flex border border-[#dce5df] border-l-0 bg-white items-center justify-center pr-[15px] rounded-r-lg w-12 cursor-pointer hover:text-primary transition-colors">
                                        <span class="material-symbols-outlined pwd-icon">visibility_off</span>
                                    </div>
                                </div>
                            </div>
                            <!-- Options -->
                            <div class="flex items-center justify-between mt-2">
                                <label class="flex items-center gap-2 cursor-pointer">
                                    <input class="rounded border-[#dce5df] text-primary focus:ring-primary h-4 w-4" type="checkbox"/>
                                    <span class="text-sm font-medium text-[#111813] dark:text-white">#{locale.getMessage('login.rememberMe')}</span>
                                </label>
                                <a class="text-sm font-bold text-primary hover:text-[#13a844] transition-colors" href="#{facesContext.externalContext.requestContextPath}/pages/user/forgot_password.xhtml">#{locale.getMessage('login.forgotPassword')}</a>
                            </div>
                            <!-- Submit Button -->
                            <h:commandButton action="#{auth.login}" value="#{locale.getMessage('login.signIn')}" styleClass="mt-4 flex w-full cursor-pointer items-center justify-center overflow-hidden rounded-lg h-12 px-4 bg-primary text-[#111813] text-base font-bold leading-normal tracking-[0.015em] hover:bg-[#13a844] transition-colors shadow-sm active:scale-[0.98]" />
                        </h:form>
                        <!-- Divider -->
                        <div class="relative my-8">
                            <div aria-hidden="true" class="absolute inset-0 flex items-center">
                                <div class="w-full border-t border-[#f0f4f2] dark:border-[#2a4034]"></div>
                            </div>
                            <div class="relative flex justify-center">
                                <span class="bg-white dark:bg-[#112116] px-2 text-sm text-[#63886f]">#{locale.getMessage('login.continueWith')}</span>
                            </div>
                        </div>
                        <!-- Social Login -->
                        <div class="grid grid-cols-2 gap-4">
                            <h:form styleClass="contents">
                                <h:commandButton id="google-login-btn" 
                                               action="#{auth.redirectToGoogleOAuth()}" 
                                               styleClass="flex items-center justify-center gap-2 h-12 rounded-lg border border-[#dce5df] hover:bg-gray-50 dark:hover:bg-[#1a3322] transition-colors bg-white dark:bg-[#112116] dark:border-[#2a4034]" 
                                               value="Google" />
                            </h:form>
                            <button class="flex items-center justify-center gap-2 h-12 rounded-lg border border-[#dce5df] hover:bg-gray-50 dark:hover:bg-[#1a3322] transition-colors bg-white dark:bg-[#112116] dark:border-[#2a4034]">
                                <img alt="Apple" class="w-5 h-5" data-alt="Apple logo" src="https://lh3.googleusercontent.com/aida-public/AB6AXuAt95QDFH8irOiy94USrDJJ0MF7mcxRCNvg_BOcxLM1BLNToTNeodr_IiejZZmGe9c9YqbHEI5hTBDlFMbRusvs2VuIOOG9KpDHhBxbpqpPI2EUqRa9pbuZOSbHewCbKdq3kFebO116Cn5YDvqPj8OoD-rJ1G-928_6YPmlTCcVO7gZI_QkpyTII-FAKtn4aoqLXIQfxyAIiKOOed2vf-wH42csihjb9oA4QaPqtQ_qQ0ICdbCLGkjMRk74Ksy6NpLYko2aDm8iY9M"/>
                                <span class="text-sm font-bold text-[#111813] dark:text-white">Apple</span>
                            </button>
                        </div>
                    
                        <div class="mt-8 text-center">
                            <p class="text-[#111813] dark:text-white text-sm">
                                #{locale.getMessage('login.noAccount')} 
                                <h:link class="font-bold text-primary hover:underline" value="#{locale.getMessage('login.signUp')}" outcome="register"/>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        <script>//<![CDATA[
            document.addEventListener('DOMContentLoaded', function() {
                var toggle = document.getElementById('pwd-toggle-login');
                if(toggle) {
                    var pwdInputs = toggle.parentElement.querySelectorAll('input[type="password"], input[type="text"]');
                    if(pwdInputs.length > 0) {
                        var pwd = pwdInputs[0];
                        var icon = toggle.querySelector('.pwd-icon');
                        toggle.addEventListener('click', function(e) {
                            e.preventDefault();
                            if(pwd.type === 'password') {
                                pwd.type = 'text';
                                icon.textContent = 'visibility';
                            } else {
                                pwd.type = 'password';
                                icon.textContent = 'visibility_off';
                            }
                        });
                    }
                }
            });
        //]]></script>
    </ui:define>
</ui:composition>