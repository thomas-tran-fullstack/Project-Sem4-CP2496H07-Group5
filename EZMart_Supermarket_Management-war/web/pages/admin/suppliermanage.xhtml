<?xml version="1.0" encoding="UTF-8"?>
<ui:composition template="/templates/admin/layout.xhtml" xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="jakarta.faces.html" xmlns:ui="jakarta.faces.facelets" xmlns:f="jakarta.faces.core">

    <ui:define name="content">
        <div class="flex-1 overflow-y-auto p-6 lg:p-10 scroll-smooth">
            <div class="max-w-7xl mx-auto space-y-8">
                <!-- Page Heading -->
                <div class="flex flex-col sm:flex-row sm:items-end justify-between gap-4">
                    <div>
                        <h2 class="text-3xl font-bold text-slate-900 dark:text-white">Supplier Management</h2>
                        <p class="text-slate-600 dark:text-slate-400 mt-1">Manage product suppliers and brands</p>
                    </div>
                    <div class="flex gap-3">
                        <button
                            class="inline-flex items-center gap-2 px-4 py-2 bg-slate-100 dark:bg-white/10 hover:bg-slate-200 dark:hover:bg-white/20 text-slate-700 dark:text-slate-300 rounded-lg font-medium transition-colors">
                            <span class="material-symbols-outlined text-lg">download</span>
                            Export Data
                        </button>
                        <h:link outcome="addsupplier"
                            class="inline-flex items-center gap-2 px-4 py-2 bg-primary hover:bg-primary/90 text-white rounded-lg font-medium transition-colors">
                            <span class="material-symbols-outlined text-lg">add</span>
                            Add Supplier
                        </h:link>
                    </div>
                </div>

                <!-- Search and Filters -->
                <div class="bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 p-6">
                    <h:form>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="md:col-span-1">
                                <div class="relative">
                                    <span
                                        class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-slate-400">search</span>
                                    <h:inputText value="#{supplierMB.searchTerm}" placeholder="Search suppliers..."
                                        class="w-full pl-10 pr-4 py-2 bg-slate-50 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-lg text-slate-900 dark:text-white placeholder-slate-500 dark:placeholder-slate-400 focus:ring-2 focus:ring-primary focus:border-transparent transition-colors" />
                                </div>
                            </div>
                            <div class="md:col-span-1 flex gap-2">
                                <h:commandButton action="#{supplierMB.searchSuppliers()}" value="Search"
                                    class="px-4 py-2 bg-primary hover:bg-primary/90 text-white rounded-lg font-medium transition-colors" />
                                <h:commandButton action="#{supplierMB.loadSuppliers()}" value="Clear"
                                    class="px-4 py-2 bg-slate-100 dark:bg-white/10 hover:bg-slate-200 dark:hover:bg-white/20 text-slate-700 dark:text-slate-300 rounded-lg font-medium transition-colors" />
                            </div>
                        </div>
                    </h:form>
                </div>

                <!-- Suppliers Table -->
                <div
                    class="bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 overflow-hidden">
                    <div class="overflow-x-auto">
                        <table class="min-w-full text-sm">
                            <thead class="bg-slate-50 dark:bg-slate-700/50">
                                <tr>
                                    <th
                                        class="px-6 py-4 text-left text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider">
                                        ID</th>
                                    <th
                                        class="px-6 py-4 text-left text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider">
                                        Supplier</th>
                                    <th
                                        class="px-6 py-4 text-left text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider">
                                        Description</th>
                                    <th
                                        class="px-6 py-4 text-left text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider">
                                        Country</th>
                                    <th
                                        class="px-6 py-4 text-left text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider">
                                        Email</th>
                                    <th
                                        class="px-6 py-4 text-left text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider">
                                        Phone</th>
                                    <th
                                        class="px-6 py-4 text-left text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider">
                                        Address</th>
                                    <th
                                        class="px-6 py-4 text-left text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider">
                                        Website</th>
                                    <th
                                        class="px-6 py-4 text-left text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider">
                                        Actions</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-slate-200 dark:divide-slate-700">
                                <ui:repeat var="supplier" value="#{supplierMB.paginatedSuppliers}">
                                    <tr class="hover:bg-slate-50 dark:hover:bg-slate-700/30 transition-colors">
                                        <td class="px-6 py-4 text-slate-900 dark:text-white font-medium">
                                            #{supplier.brandID}</td>
                                        <td class="px-6 py-4">
                                            <div class="flex items-center gap-3">
                                                <div
                                                    class="w-8 h-8 rounded-lg bg-slate-100 dark:bg-slate-600 flex items-center justify-center">
                                                    <span
                                                        class="material-symbols-outlined text-slate-600 dark:text-slate-300">business</span>
                                                </div>
                                                <span
                                                    class="text-slate-900 dark:text-white font-medium">#{supplier.brandName}</span>
                                            </div>
                                        </td>
                                        <td class="px-6 py-4 text-slate-600 dark:text-slate-300 max-w-xs truncate">
                                            #{supplier.description}</td>
                                        <td class="px-6 py-4">
                                            <span
                                                class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300">
                                                #{supplier.country}
                                            </span>
                                        </td>
                                        <td class="px-6 py-4 text-slate-600 dark:text-slate-300">#{supplier.email}</td>
                                        <td class="px-6 py-4 text-slate-600 dark:text-slate-300">#{supplier.phone}</td>
                                        <td class="px-6 py-4 text-slate-600 dark:text-slate-300 max-w-xs truncate">
                                            #{supplier.address}</td>
                                        <td class="px-6 py-4 text-slate-600 dark:text-slate-300">
                                            <h:link value="#{supplier.website}" target="_blank"
                                                class="text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300"
                                                rendered="#{supplier.website != null and supplier.website != ''}" />
                                            <span class="text-slate-400"
                                                rendered="#{supplier.website == null or supplier.website == ''}">N/A</span>
                                        </td>
                                        <td class="px-6 py-4">
                                            <h:form>
                                                <div class="flex items-center gap-2">
                                                    <h:link outcome="editsupplier"
                                                        class="p-1.5 text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-md border-none bg-transparent transition-colors">
                                                        <f:param name="supplierId" value="#{supplier.brandID}" />
                                                        <span class="material-symbols-outlined text-lg">edit</span>
                                                    </h:link>
                                                    <h:commandLink action="#{supplierMB.deleteSupplier(supplier)}"
                                                        onclick="return confirm('Are you sure you want to delete this supplier?')"
                                                        class="p-1.5 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-md border-none bg-transparent transition-colors">
                                                        <span class="material-symbols-outlined text-lg">delete</span>
                                                    </h:commandLink>
                                                </div>
                                            </h:form>
                                        </td>
                                    </tr>
                                </ui:repeat>
                            </tbody>
                        </table>
                    </div>

                    <!-- Pagination -->
                    <div
                        class="flex items-center justify-between px-6 py-4 bg-slate-50 dark:bg-slate-700/50 border-t border-slate-200 dark:border-slate-700">
                        <div class="text-sm text-slate-600 dark:text-slate-300">
                            Showing #{supplierMB.currentPage * supplierMB.pageSize - supplierMB.pageSize + 1} to
                            #{supplierMB.currentPage * supplierMB.pageSize > supplierMB.totalRecords ?
                            supplierMB.totalRecords : supplierMB.currentPage * supplierMB.pageSize}
                            of #{supplierMB.totalRecords} entries
                        </div>

                        <h:form>
                            <div class="flex items-center gap-2">
                                <h:commandLink action="#{supplierMB.previousPage()}"
                                    disabled="#{supplierMB.currentPage == 1}"
                                    styleClass="px-3 py-1 text-sm bg-white dark:bg-slate-600 border border-slate-300 dark:border-slate-500 rounded-md hover:bg-slate-50 dark:hover:bg-slate-500 disabled:opacity-50 disabled:cursor-not-allowed">
                                    Previous
                                </h:commandLink>
                                <span class="text-sm text-slate-600 dark:text-slate-300">
                                    Page #{supplierMB.currentPage} of #{supplierMB.totalPages}
                                </span>

                                <h:commandLink action="#{supplierMB.nextPage()}"
                                    disabled="#{supplierMB.currentPage == supplierMB.totalPages}"
                                    styleClass="px-3 py-1 text-sm bg-white dark:bg-slate-600 border border-slate-300 dark:border-slate-500 rounded-md hover:bg-slate-50 dark:hover:bg-slate-500 disabled:opacity-50 disabled:cursor-not-allowed">
                                    Next
                                </h:commandLink>
                            </div>
                        </h:form>
                    </div>
                </div>
            </div>
        </div>
        <h:panelGroup id="toastContainer" layout="block"
            styleClass="fixed top-6 left-1/2 -translate-x-1/2 z-50 w-full max-w-md px-4">
            <div class="fixed top-6 left-1/2 -translate-x-1/2 z-50 w-full max-w-md px-4">
                <ui:repeat value="#{facesContext.messageList}" var="msg">
                    <div class="toast-item mb-2 px-6 py-4 rounded-xl shadow-lg text-white
            #{msg.severity == 'INFO' ? 'bg-green-600' :
              msg.severity == 'ERROR' ? 'bg-red-600' :
              msg.severity == 'WARN' ? 'bg-yellow-500 text-black' :
              'bg-blue-600'}">

                        <div class="font-semibold mb-1">
                            #{msg.summary}
                        </div>
                        <div class="text-sm opacity-90">
                            #{msg.detail}
                        </div>
                    </div>
                </ui:repeat>
            </div>
        </h:panelGroup>

        <script>
            document.querySelectorAll('.toast-item').forEach((el, index) => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(-20px)';
                setTimeout(() => {
                    el.style.opacity = '1';
                    el.style.transform = 'translateY(0)';
                    el.style.transition = 'all 0.3s ease';
                }, 100 * index);

                setTimeout(() => {
                    el.style.opacity = '0';
                    el.style.transform = 'translateY(-20px)';
                    setTimeout(() => el.remove(), 300);
                }, 3000);
            });
        </script>
    </ui:define>
</ui:composition>