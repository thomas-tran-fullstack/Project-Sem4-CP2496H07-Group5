<!DOCTYPE html>
<html>
<head>
    <title>Test Staff API</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .section { margin: 20px 0; padding: 20px; border: 1px solid #ccc; }
        textarea { width: 100%; height: 300px; }
        button { padding: 10px 20px; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>Test Staff API</h1>
    
    <div class="section">
        <h2>API Test</h2>
        <button onclick="testAPI()">Test /resources/api/users?role=STAFF</button>
        <div id="result"></div>
    </div>

    <script>
        function testAPI() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<p>Loading...</p>';
            
            const apiUrl = '/EZMart_Supermarket_Management-war/resources/api/users?role=STAFF';
            console.log('Testing API:', apiUrl);
            
            fetch(apiUrl)
                .then(response => {
                    console.log('Response status:', response.status);
                    console.log('Response headers:', response.headers);
                    return response.text().then(text => ({ status: response.status, text: text }));
                })
                .then(data => {
                    console.log('Response text:', data.text);
                    
                    if (data.status !== 200) {
                        resultDiv.innerHTML = '<p class="error">Error: Status ' + data.status + '</p>';
                        resultDiv.innerHTML += '<pre>' + escapeHtml(data.text) + '</pre>';
                        return;
                    }
                    
                    try {
                        const json = JSON.parse(data.text);
                        resultDiv.innerHTML = '<p class="success">Success! Received ' + json.length + ' items</p>';
                        resultDiv.innerHTML += '<pre>' + JSON.stringify(json, null, 2) + '</pre>';
                    } catch (e) {
                        resultDiv.innerHTML = '<p class="error">Error parsing JSON: ' + e.message + '</p>';
                        resultDiv.innerHTML += '<pre>' + escapeHtml(data.text) + '</pre>';
                    }
                })
                .catch(error => {
                    console.error('Fetch error:', error);
                    resultDiv.innerHTML = '<p class="error">Fetch error: ' + error.message + '</p>';
                });
        }
        
        function escapeHtml(text) {
            const map = {
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#039;'
            };
            return text.replace(/[&<>"']/g, m => map[m]);
        }
    </script>
</body>
</html>
